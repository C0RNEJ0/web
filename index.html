<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prueba de Audio</title>
  <style>
    :root { color-scheme: light dark; }
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 2rem;
      line-height: 1.5;
      display: grid;
      place-items: center;
      min-height: 100dvh;
      background: rgba(0,0,0,0.02);
    }
    .card {
      width: min(640px, 92vw);
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 16px;
      padding: 1.25rem;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      background: #fff;
    }
    h1 { font-size: 1.25rem; margin: 0 0 0.5rem 0; }
    p { margin: 0.25rem 0; }
    .row { display: flex; gap: 0.75rem; align-items: center; flex-wrap: wrap; margin-top: 0.75rem; }
    button {
      border: 0; border-radius: 999px; padding: 0.6rem 1rem; cursor: pointer;
      background: #111; color: #fff; font-weight: 600;
    }
    .muted-note { font-size: 0.9rem; opacity: 0.8; }
    .status { margin-top: 0.5rem; font-size: 0.95rem; }
    audio { width: 100%; margin-top: 0.5rem; }
    @media (prefers-color-scheme: dark) {
      body { background: #0b0b0c; }
      .card { background: #121214; border-color: rgba(255,255,255,0.08); }
      button { background: #e7e7e7; color: #111; }
    }
  </style>
</head>
<body>
  <main class="card">
    <h1>Reproductor de audio</h1>
    <p class="muted-note">El audio intenta iniciar en silencio (requisito de los navegadores). Haz clic en el bot√≥n o en cualquier parte para activar el sonido.</p>

    <!--
      IMPORTANTE:
      - La primera fuente usa el nombre con acentos: "V√≠deo-sem-t√≠tulo.mp3".
      - La segunda es un fallback por si lo renombras sin acentos: "video-sem-titulo.mp3".
      - Deja ambos si no est√°s seguro; el navegador usar√° la que cargue correctamente.
    -->
    <audio id="meuAudio" preload="auto" controls autoplay muted>
      <source src="V√≠deo-sem-t√≠tulo.mp3" type="audio/mpeg" />
      <source src="video-sem-titulo.mp3" type="audio/mpeg" />
      Tu navegador no soporta la etiqueta <code>audio</code>.
    </audio>

    <div class="row">
      <button id="unmuteBtn" type="button">üîä Activar sonido</button>
      <button id="playPauseBtn" type="button">‚èØÔ∏è Reproducir / Pausar</button>
      <button id="muteToggleBtn" type="button">ü§´ Silenciar / Sonar</button>
    </div>

    <p id="status" class="status">Cargando audio‚Ä¶</p>
  </main>

  <script>
    (function () {
      const audio = document.getElementById('meuAudio');
      const statusEl = document.getElementById('status');
      const unmuteBtn = document.getElementById('unmuteBtn');
      const playPauseBtn = document.getElementById('playPauseBtn');
      const muteToggleBtn = document.getElementById('muteToggleBtn');

      // Utilidad para mensajes
      function setStatus(msg) { statusEl.textContent = msg; }

      // Intento de autoplay en silencio al cargar
      async function tryAutoplayMuted() {
        try {
          await audio.play();
          setStatus('Reproduciendo (silenciado por pol√≠tica de autoplay)‚Ä¶');
        } catch (e) {
          // Si falla, quedar√° esperando interacci√≥n del usuario
          setStatus('Autoplay bloqueado hasta tu interacci√≥n. Haz clic para activar sonido.');
        }
      }

      // Al primer gesto del usuario, intentamos activar con sonido
      async function startOnce() {
        audio.muted = false;
        try {
          await audio.play();
          setStatus('Reproduciendo con sonido ‚úÖ');
        } catch (e) {
          console.warn(e);
          setStatus('No pude reproducir autom√°ticamente. Usa los botones de arriba.');
        } finally {
          window.removeEventListener('click', startOnce);
          window.removeEventListener('keydown', startOnce);
          window.removeEventListener('touchstart', startOnce);
        }
      }

      // Botones
      unmuteBtn.addEventListener('click', async () => {
        audio.muted = false;
        try {
          await audio.play();
          setStatus('Reproduciendo con sonido ‚úÖ');
        } catch (e) {
          console.warn(e);
          setStatus('No se pudo iniciar la reproducci√≥n. Revisa la consola del navegador.');
        }
      });

      playPauseBtn.addEventListener('click', async () => {
        try {
          if (audio.paused) {
            await audio.play();
            setStatus(audio.muted ? 'Reproduciendo (silenciado)‚Ä¶' : 'Reproduciendo con sonido ‚úÖ');
          } else {
            audio.pause();
            setStatus('Pausado ‚è∏Ô∏è');
          }
        } catch (e) {
          console.warn(e);
          setStatus('No se pudo cambiar el estado de reproducci√≥n.');
        }
      });

      muteToggleBtn.addEventListener('click', () => {
        audio.muted = !audio.muted;
        setStatus(audio.muted ? 'Silenciado ü§´' : 'Con sonido üîä');
      });

      // Mensajes de error m√°s claros
      audio.addEventListener('error', () => {
        let msg = 'Error cargando el audio.';
        const err = audio.error;
        if (err) {
          switch (err.code) {
            case MediaError.MEDIA_ERR_ABORTED:
              msg = 'Carga abortada por el usuario o la p√°gina.';
              break;
            case MediaError.MEDIA_ERR_NETWORK:
              msg = 'Fallo de red al descargar el audio (revisa conexi√≥n y ruta).';
              break;
            case MediaError.MEDIA_ERR_DECODE:
              msg = 'El archivo no se pudo decodificar (posible corrupci√≥n o formato no soportado).';
              break;
            case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
              msg = 'Archivo no encontrado o formato no soportado. Verifica que el MP3 est√© en la misma carpeta y que el nombre coincida exactamente.';
              break;
          }
        }
        msg += ' Tip: Si tu archivo se llama ‚ÄúV√≠deo-sem-t√≠tulo.mp3‚Äù y no carga, prueba renombrarlo a ‚Äúvideo-sem-titulo.mp3‚Äù y deja ambas <source>.';
        setStatus(msg);
      });

      // Estado informativo cuando puede reproducirse
      audio.addEventListener('canplay', () => {
        if (audio.muted) {
          setStatus('Listo para reproducir (silenciado). Haz clic en ‚ÄúActivar sonido‚Äù.');
        } else {
          setStatus('Listo para reproducir con sonido.');
        }
      });

      // Disparadores de ‚Äúprimer gesto‚Äù
      window.addEventListener('click', startOnce, { once: true });
      window.addEventListener('keydown', startOnce, { once: true });
      window.addEventListener('touchstart', startOnce, { once: true });

      // Intento inicial
      tryAutoplayMuted();
    })();
  </script>
</body>
</html>
