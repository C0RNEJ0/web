<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Audio + letras</title>
  <style>
    /* Minimal, como el original: fondo liso y solo el audio + texto grande */
    :root { color-scheme: light dark; }
    html, body { height: 100%; margin: 0; }
    body {
      display: grid; place-items: center;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }
    /* Ubicamos el reproductor arriba-izquierda (opcional) */
    audio { position: fixed; top: 12px; left: 12px; max-width: min(500px, 80vw); }
    /* Texto de la frase en grande, centrado */
    #lyric {
      text-align: center;
      font-weight: 800;
      letter-spacing: .3px;
      font-size: clamp(28px, 8vw, 80px);
      line-height: 1.1;
      padding: 16px;
      user-select: none;
    }
  </style>
</head>
<body>
  <!-- Reproductor tal cual, sin extras -->
  <audio id="meuAudio" preload="auto" controls>
    <source src="Vídeo-sem-título.mp3" type="audio/mpeg" />
    <source src="video-sem-titulo.mp3" type="audio/mpeg" />
    Tu navegador no soporta la etiqueta <code>audio</code>.
  </audio>

  <!-- Solo el texto de la frase actual -->
  <div id="lyric">…</div>

  <script>
    // === Tu arreglo de frases (duracao en milisegundos) ===
    const frases = [
      { texto: "...", duracao: 1750 },
      { texto: "I", duracao: 350 },
      { texto: "wanna", duracao: 400 },
      { texto: "da-", duracao: 400 },
      { texto: "I", duracao: 350 },
      { texto: "wanna", duracao: 400 },
      { texto: "dance", duracao: 400 },
      { texto: "in", duracao: 200 },
      { texto: "the", duracao: 200 },
      { texto: "lights", duracao: 800 },
      { texto: "...", duracao: 500 },

      { texto: "I", duracao: 300 },
      { texto: "wanna", duracao: 400 },
      { texto: "ro-", duracao: 300 },
      { texto: "I", duracao: 300 },
      { texto: "wanna", duracao: 400 },
      { texto: "rock", duracao: 400 },
      { texto: "your", duracao: 500 },
      { texto: "body", duracao: 1150 },

      { texto: "I", duracao: 300 },
      { texto: "wanna", duracao: 400 },
      { texto: "go", duracao: 300 },
      { texto: "I", duracao: 300 },
      { texto: "wanna", duracao: 400 },
      { texto: "go", duracao: 300 },
      { texto: "for", duracao: 350 },
      { texto: "a", duracao: 300 },
      { texto: "ride", duracao: 800 },
      { texto: "...", duracao: 400 },

      { texto: "Hop", duracao: 400 },
      { texto: "in", duracao: 250 },
      { texto: "the", duracao: 250 },
      { texto: "music", duracao: 500 },
      { texto: "and", duracao: 350 },
      { texto: "rock", duracao: 450 },
      { texto: "your", duracao: 500 },
      { texto: "body", duracao: 700 },
      { texto: "right", duracao: 400 },

      { texto: "Rock", duracao: 300 },
      { texto: "that", duracao: 200 },
      { texto: "body", duracao: 300 },
      { texto: "come on", duracao: 250 },
      { texto: "come on", duracao: 150 },
      { texto: "come on come on", duracao: 250 },
      { texto: "come on come on", duracao: 150 },
      { texto: "rock", duracao: 300 },
      { texto: "that", duracao: 200 },
      { texto: "body", duracao: 300 },
      { texto: "rock", duracao: 300 },
      { texto: "that", duracao: 200 },
      { texto: "body", duracao: 500 },
      { texto: "...", duracao: 200000 }
    ];

    // === Referencias ===
    const audio = document.getElementById('meuAudio');
    const lyric = document.getElementById('lyric');

    // === Intento de reproducir como en tu original ===
    audio.play().catch(() => {
      // Si el navegador bloquea autoplay, lo intentamos al primer gesto:
      const once = async () => {
        try { await audio.play(); } catch {}
        window.removeEventListener('click', once);
        window.removeEventListener('keydown', once);
        window.removeEventListener('touchstart', once);
      };
      window.addEventListener('click', once, { once: true });
      window.addEventListener('keydown', once, { once: true });
      window.addEventListener('touchstart', once, { once: true });
    });

    // === Precalcular inicios (ms) para cada frase ===
    const cueStartMs = [];
    (function buildCues(){
      let acc = 0;
      for (const f of frases) { cueStartMs.push(acc); acc += (Number(f.duracao) || 0); }
    })();
    const totalLyricsMs = cueStartMs.length
      ? cueStartMs[cueStartMs.length - 1] + (Number(frases.at(-1).duracao) || 0)
      : 0;

    // Buscar índice de frase para un tiempo dado (ms)
    function findPhraseIndex(tMs) {
      let i = 0;
      for (let k = 0; k < cueStartMs.length; k++) {
        if (cueStartMs[k] <= tMs) i = k; else break;
      }
      return i;
    }

    function updateLyric(tMs) {
      const i = findPhraseIndex(tMs);
      lyric.textContent = frases[i]?.texto ?? '…';
    }

    // Sincronizar con el tiempo del audio
    audio.addEventListener('timeupdate', () => {
      updateLyric(audio.currentTime * 1000);
    });
    audio.addEventListener('seeking', () => updateLyric(audio.currentTime * 1000));
    audio.addEventListener('seeked',  () => updateLyric(audio.currentTime * 1000));
    audio.addEventListener('ended',   () => updateLyric(totalLyricsMs));

    // Al cargar, mostrar la primera frase
    updateLyric(0);
  </script>
</body>
</html>
